<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Taming IO Replica - Fix</title>
    <script src="https://pixijs.download/v8.x/pixi.min.js"></script>
    <style>
        body { margin: 0; overflow: hidden; background-color: #1099bb; font-family: Arial, sans-serif; }
        #ui-container {
            position: absolute;
            top: 10px;
            left: 10px;
            color: white;
            font-weight: bold;
            text-shadow: 2px 2px 0px #000;
            pointer-events: none;
        }
        .weapon-menu {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
        }
        .btn {
            padding: 10px 20px;
            border: 2px solid white;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            font-weight: bold;
        }
        .ak { background: #d35400; }
        .sniper { background: #2980b9; }
        .mg { background: #27ae60; }
    </style>
</head>
<body>

    <div id="ui-container">
        üí∞ ORO: $50 | ‚ù§Ô∏è VIDA: 100%
    </div>

    <div class="weapon-menu">
        <div class="btn ak">AK-47</div>
        <div class="btn sniper">SNIPER</div>
        <div class="btn mg">MG</div>
    </div>

    <script>
        // Inicializar PixiJS v8
        const app = new PIXI.Application();

        async function init() {
            await app.init({ 
                background: '#1099bb', 
                resizeTo: window,
                antialias: true 
            });
            document.body.appendChild(app.canvas);

            // --- JUGADOR (Cuerpo + Manos integradas) ---
            const player = new PIXI.Container();
            player.x = window.innerWidth / 2;
            player.y = window.innerHeight / 2;
            app.stage.addChild(player);

            // Cuerpo
            const body = new PIXI.Graphics()
                .beginFill(0xee8033)
                .lineStyle(4, 0x000000)
                .drawCircle(0, 0, 30)
                .endFill();
            
            // Manos (posicionadas correctamente para que no "vuelen")
            const handL = new PIXI.Graphics()
                .beginFill(0xee8033)
                .lineStyle(3, 0x000000)
                .drawCircle(-25, 25, 10)
                .endFill();

            const handR = new PIXI.Graphics()
                .beginFill(0xee8033)
                .lineStyle(3, 0x000000)
                .drawCircle(25, 25, 10)
                .endFill();

            player.addChild(body, handL, handR);

            // --- BALAS ---
            const bullets = [];

            window.addEventListener('mousedown', () => {
                const bullet = new PIXI.Graphics()
                    .beginFill(0x333333)
                    .drawCircle(0, 0, 6)
                    .endFill();

                bullet.x = player.x;
                bullet.y = player.y;
                
                // C√°lculo de direcci√≥n seg√∫n la rotaci√≥n del personaje
                const speed = 15;
                bullet.dx = Math.cos(player.rotation + Math.PI/2) * speed;
                bullet.dy = Math.sin(player.rotation + Math.PI/2) * speed;

                app.stage.addChild(bullet);
                bullets.push(bullet);
            });

            // --- LOOP DEL JUEGO ---
            app.ticker.add(() => {
                // Rotar personaje hacia el mouse
                const mouse = app.renderer.events.pointer;
                const angle = Math.atan2(mouse.y - player.y, mouse.x - player.x);
                player.rotation = angle - Math.PI/2;

                // Mover balas
                for (let i = bullets.length - 1; i >= 0; i--) {
                    bullets[i].x += bullets[i].dx;
                    bullets[i].y += bullets[i].dy;

                    // Borrar si salen de pantalla
                    if (bullets[i].x < 0 || bullets[i].x > window.innerWidth || 
                        bullets[i].y < 0 || bullets[i].y > window.innerHeight) {
                        app.stage.removeChild(bullets[i]);
                        bullets.splice(i, 1);
                    }
                }
            });
        }

        init();
    </script>
</body>
</html>
