<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Zombies BR - New Look</title>
    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background: #000; font-family: 'Arial Black', sans-serif; }
        canvas { display: none; background: #0b0b0b; }
        
        /* PANTALLA DE INICIO CON TU NUEVA FOTO */
        #menu { 
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            height: 100%; color: white; text-align: center;
            /* Aquí puse una imagen de zombie tipo cartoon como la que me pasaste */
            background: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.8)), 
                        url('https://img.freepik.com/vector-gratis/personaje-dibujos-animados-zombie-estilo-plano-diseno_23-2149114675.jpg');
            background-size: cover;
            background-position: center;
        }

        .btn {
            background: #2ecc71; border: none; padding: 15px 40px; color: white;
            font-size: 24px; cursor: pointer; border-radius: 8px; margin: 10px;
            transition: 0.2s; border-bottom: 5px solid #27ae60; text-transform: uppercase;
        }
        .btn:hover { background: #27ae60; transform: scale(1.05); }
        .btn-tienda { background: #f1c40f; border-bottom: 5px solid #d4ac0d; color: #000; }

        #ui-juego { position: absolute; top: 10px; left: 20px; color: white; display: none; pointer-events: none; text-shadow: 3px 3px #000; }
        .ammo-bar { color: #ff3333; font-size: 22px; margin-top: 5px; }
        #banco-display { font-size: 30px; color: #f1c40f; background: rgba(0,0,0,0.7); padding: 10px 20px; border-radius: 10px; border: 2px solid #f1c40f; margin-bottom: 20px; }
    </style>
</head>
<body>

    <div id="menu">
        <h1 style="font-size: 80px; color: #ffffff; margin-bottom: 0; text-shadow: 5px 5px #ff3333;">ZOMBIES BR</h1>
        <p style="font-size: 20px; letter-spacing: 5px; margin-top: 0;">SOBREVIVE A LA HORDA</p>
        
        <div id="banco-display">BANCO: $<span id="banco-total">0</span></div>
        
        <button class="btn" onclick="empezarJuego()">INICIAR PARTIDA</button><br>
        <button class="btn btn-tienda" id="btn-comprar" onclick="equiparAmetralladora()">AMETRALLADORA ($100)</button>
    </div>

    <div id="ui-juego">
        <h2 style="color: gold; font-size: 35px; margin: 0;">PARTIDA: $<span id="puntos">0</span></h2>
        <div id="arma-info" class="ammo-bar">ARMA: Pistola Básica</div>
        <div id="municion-div" class="ammo-bar" style="display:none; color: #ff3333;">BALAS: <span id="balas-count">200</span> / 200</div>
    </div>

    <canvas id="juego"></canvas>

    <script>
        const canvas = document.getElementById("juego");
        const ctx = canvas.getContext("2d");
        const menu = document.getElementById("menu");
        const ui = document.getElementById("ui-juego");

        // MEMORIA DEL JUEGO
        let banco = 0;
        let enJuego = false;
        let armaEquipada = "pistola"; 

        let jugador, zombies, balas, monedas, teclas, puntosPartida, balasAmetralladora;

        function empezarJuego() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            enJuego = true;
            menu.style.display = "none";
            canvas.style.display = "block";
            ui.style.display = "block";
            
            puntosPartida = 0;
            balasAmetralladora = 200;
            document.getElementById("puntos").innerText = "0";
            
            if(armaEquipada === "ametralladora") {
                document.getElementById("arma-info").innerText = "MODO: Ametralladora Ligera";
                document.getElementById("municion-div").style.display = "block";
                document.getElementById("balas-count").innerText = "200";
            } else {
                document.getElementById("arma-info").innerText = "MODO: Pistola Básica";
                document.getElementById("municion-div").style.display = "none";
            }

            jugador = { x: canvas.width/2, y: canvas.height/2, tam: 30, vel: 5 };
            zombies = []; balas = []; monedas = []; teclas = {};
            for(let i=0; i<7; i++) crearZombie();
            bucle();
        }

        function crearZombie() {
            zombies.push({ x: Math.random()*canvas.width, y: Math.random()<0.5?-50:canvas.height+50, tam: 40, vel: 2.2 });
        }

        window.addEventListener("keydown", (e) => teclas[e.key.toLowerCase()] = true);
        window.addEventListener("keyup", (e) => teclas[e.key.toLowerCase()] = false);

        let cooldown = 0;
        window.addEventListener("mousedown", (e) => {
            if(!enJuego) return;
            const ahora = Date.now();
            
            if(armaEquipada === "pistola") {
                if(ahora - cooldown > 400) { disparar(e, "yellow"); cooldown = ahora; }
            } else if(armaEquipada === "ametralladora" && balasAmetralladora > 0) {
                if(ahora - cooldown > 90) { 
                    disparar(e, "#ff0000"); // ROJO USA
                    balasAmetralladora--;
                    document.getElementById("balas-count").innerText = balasAmetralladora;
                    cooldown = ahora; 
                }
            }
        });

        function disparar(e, color) {
            const ang = Math.atan2(e.clientY - (jugador.y+15), e.clientX - (jugador.x+15));
            balas.push({ x: jugador.x+15, y: jugador.y+15, vx: Math.cos(ang)*16, vy: Math.sin(ang)*16, color: color });
        }

        function actualizar() {
            if(!enJuego) return;
            if (teclas["w"] && jugador.y > 0) jugador.y -= jugador.vel;
            if (teclas["s"] && jugador.y < canvas.height-30) jugador.y += jugador.vel;
            if (teclas["a"] && jugador.x > 0) jugador.x -= jugador.vel;
            if (teclas["d"] && jugador.x < canvas.width-30) jugador.x += jugador.vel;

            zombies.forEach((z, zi) => {
                let dx = (jugador.x+15) - (z.x+20);
                let dy = (jugador.y+15) - (z.y+20);
                let dist = Math.sqrt(dx*dx + dy*dy);
                z.x += (dx/dist) * z.vel; z.y += (dy/dist) * z.vel;
                if(dist < 30) morir();
            });

            balas.forEach((b, bi) => {
                b.x += b.vx; b.y += b.vy;
                if(b.x < 0 || b.x > canvas.width || b.y < 0 || b.y > canvas.height) balas.splice(bi, 1);
                zombies.forEach((z, zi) => {
                    if(b.x > z.x && b.x < z.x+z.tam && b.y > z.y && b.y < z.y+z.tam) {
                        monedas.push({x: z.x, y: z.y});
                        zombies.splice(zi, 1); balas.splice(bi, 1);
                        crearZombie();
                    }
                });
            });

            monedas.forEach((m, mi) => {
                if(Math.abs(jugador.x - m.x) < 40 && Math.abs(jugador.y - m.y) < 40) {
                    puntosPartida += 10;
                    document.getElementById("puntos").innerText = puntosPartida;
                    monedas.splice(mi, 1);
                }
            });
        }

        function dibujar() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            // Monedas
            ctx.fillStyle = "gold"; monedas.forEach(m => { ctx.beginPath(); ctx.arc(m.x+20, m.y+20, 10, 0, 7); ctx.fill(); });
            // Jugador
            ctx.fillStyle = "#0077ff"; ctx.shadowBlur = 10; ctx.shadowColor = "#0077ff";
            ctx.fillRect(jugador.x, jugador.y, 30, 30);
            ctx.shadowBlur = 0;
            // Zombies
            ctx.fillStyle = "#8b0000"; zombies.forEach(z => ctx.fillRect(z.x, z.y, 40, 40));
            // Balas
            balas.forEach(b => { ctx.fillStyle = b.color; ctx.fillRect(b.x, b.y, 8, 8); });
        }

        function morir() {
            enJuego = false;
            banco += puntosPartida;
            document.getElementById("banco-total").innerText = banco;
            alert("TE COMIERON... Pero guardamos $" + puntosPartida + " en tu banco.");
            canvas.style.display = "none"; ui.style.display = "none"; menu.style.display = "flex";
            armaEquipada = "pistola"; // Se resetea el arma al morir para que tengas que volver a equiparla
        }

        function equiparAmetralladora() {
            if(banco >= 100) {
                banco -= 100;
                armaEquipada = "ametralladora";
                document.getElementById("banco-total").innerText = banco;
                alert("¡EQUIPADA! Tienes 200 balas rojas.");
            } else {
                alert("Necesitas $100. ¡Sigue matando zombies!");
            }
        }

        function bucle() { if(enJuego) { actualizar(); dibujar(); requestAnimationFrame(bucle); } }
    </script>
</body>
</html>
